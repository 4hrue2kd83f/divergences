namespace = dvg_granada

# War of Independence
dvg_granada.1 = {
	type = country_event
	placement = ROOT

	title = dvg_granada.1.t
	desc = dvg_granada.1.d
	flavor = dvg_granada.1.f
	
	event_image = {
		video = "southamerica_war_civilians"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/war_civilians"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	trigger = {
	}
		
	# For Spain!
	option = {
		name = dvg_granada.1.a
		default_option = yes
		add_journal_entry = {
			type = je_colombian_war_of_independence_GRA
		}
		add_loyalists = {
			value = 0.1
			culture = cu:granadan
		}
		ai_chance = {
			base = 1
		}
	}
}

# The Colombian Alliance is Defeated
dvg_granada.2 = {
	type = country_event
	placement = ROOT

	title = dvg_granada.2.t
	desc = dvg_granada.2.d
	flavor = dvg_granada.2.f
	
	event_image = {
		video = "southamerica_aristocrats"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/aristocrats"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	trigger = {
	}
	
	# We stand with Spain!
	option = {
		name = dvg_granada.2.a
		add_loyalists = {
			value = 0.1
		}
		hidden_effect = {
			c:SPA = {
				remove_diplomatic_pact = {
					country = c:GRA
					type = puppet
				}
			}
		}
		c:SPA = {
			create_diplomatic_pact = {
				country = c:GRA
				type = dominion
			}
		}
		ai_chance = {
			base = 0
		}
	}
}

# The Colombian Alliance has won the War of Independence
dvg_granada.3 = {
	type = country_event
	placement = ROOT

	title = dvg_granada.3.t
	desc = dvg_granada.3.d
	flavor = dvg_granada.3.f
	
	event_image = {
		video = "southamerica_aristocrats"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/aristocrats"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	trigger = {
	}
		
	# Independence!
	option = {
		name = dvg_granada.3.a
		default_option = yes
		add_loyalists = {
			value = 0.1
		}
		ig:ig_rural_folk = {
				add_ruling_interest_group = yes
				add_modifier = {
                    name = dvg_approval_buff
                    days = 730
                    is_decaying = yes
				}
		}		
		c:SPA = {
			remove_diplomatic_pact = {
				country = c:GRA
				type = puppet
			}
		}
		change_relations = {
			country = c:SPA
			value = -50
		}
		hidden_effect = {
			if = {
				limit = {
					has_law = law_type:law_monarchy
				}
				activate_law = law_type:law_presidential_republic
			}
		}
		ai_chance = {
			base = 1
		}
	}

	# We stand with Spain!
	option = {
		name = dvg_granada.3.b
		add_radicals = {
			value = 0.1
		}
		hidden_effect = {
			c:SPA = {
				remove_diplomatic_pact = {
					country = c:GRA
					type = puppet
				}
			}
		}
		c:SPA = {
			create_diplomatic_pact = {
				country = c:GRA
				type = dominion
			}
		}
		ai_chance = {
			base = 0
		}
	}
}

# Truce of 1840
dvg_granada.4 = {
	type = country_event
	placement = ROOT

	title = dvg_granada.4.t
	desc = dvg_granada.4.d
	flavor = dvg_granada.4.f
	
	event_image = {
		video = "southamerica_aristocrats"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/aristocrats"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	trigger = {
	}
	
	# We stand with Spain... for now.
	option = {
		name = dvg_granada.4.a
		hidden_effect = {
			c:SPA = {
				remove_diplomatic_pact = {
					country = c:GRA
					type = puppet
				}
			}
		}
		c:SPA = {
			create_diplomatic_pact = {
				country = c:GRA
				type = dominion
			}
		}
		ai_chance = {
			base = 0
		}
	}
}

# The Herrera Revolution
dvg_granada.5 = {
	type = country_event
	placement = ROOT

	title = dvg_granada.5.t
	desc = dvg_granada.5.d
	flavor = dvg_granada.5.f
	
	event_image = {
		video = "southamerica_aristocrats"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/aristocrats"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	trigger = {
	}
	
	immediate = {
		if = {
			limit = {
				NOT = { exists = c:SAN }
			}
			create_country = { # Herreria
				tag = SAN
				origin = this
				state = s:STATE_ANTIOQUIA.region_state:GRA
				state = s:STATE_CUNDINAMARCA.region_state:GRA
				state = s:STATE_CAUCA.region_state:GRA
				on_created = {
					if = {
						limit = {
							NOT = {
								has_law = law_type:law_presidential_republic
							}
						}
						activate_law = law_type:law_presidential_republic
					}
				}
			}
		}
		
		c:SAN = {
			create_character = {
				ruler = yes
				is_general = yes
				historical = yes
				first_name = Guillermo
				last_name = Blanco
				dna = dna_francisco_de_paula_santander
				birth_date = 1789.12.10
				hq = region_gran_colombia
				interest_group = ig_armed_forces
				ideology = ideology_ethno_nationalist
				traits = {
					meticulous
					experienced_defensive_strategist
					firebrand
				}
			}
		}
		c:SAN = { save_scope_as = scope_SAN }
	}
	
	# We must safeguard our borders
	option = {
		name = dvg_granada.5.a
		default_option = yes	
		create_diplomatic_play = {
			target_country = c:SAN
			war = no
			type = dp_annex_war
			add_war_goal = {
				holder = c:SAN
				type = annex_country
				target_country = c:GRA
			}
		}
		ai_chance = {
			base = 1
		}
	}

	# de Blanco shall lead us to victory (play as Herreria)
	option = {
		name = dvg_granada.5.b		
		create_diplomatic_play = {
			target_country = c:SAN
			war = no
			type = dp_annex_war
			add_war_goal = {
				holder = c:SAN
				type = annex_country
				target_country = c:GRA
			}
		}
		play_as = c:SAN
		ai_chance = {
			base = 0
		}
	}
	
	# Let Herreria go
	option = {
		name = dvg_granada.5.c
		c:GRA = {
			create_truce = {
				country = c:SAN
				months = 48
			}
		}
	}
}