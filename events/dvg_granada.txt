namespace = dvg_granada

# War of Independence
dvg_granada.1 = {
	type = country_event
	placement = ROOT

	title = dvg_granada.1.t
	desc = dvg_granada.1.d
	flavor = dvg_granada.1.f
	
	event_image = {
		video = "southamerica_war_civilians"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/war_civilians"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	trigger = {
	}
		
	# For Spain!
	option = {
		name = dvg_granada.1.a
		default_option = yes
		add_journal_entry = {
			type = je_colombian_war_of_independence_GRA
		}
		add_loyalists = {
			value = 0.1
			culture = cu:granadan
		}
		ai_chance = {
			base = 1
		}
	}
}

# The Colombian Alliance is Defeated
dvg_granada.2 = {
	type = country_event
	placement = ROOT

	title = dvg_granada.2.t
	desc = dvg_granada.2.d
	flavor = dvg_granada.2.f
	
	event_image = {
		video = "southamerica_aristocrats"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/aristocrats"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	trigger = {
	}
	
	# We stand with Spain!
	option = {
		name = dvg_granada.2.a
		add_loyalists = {
			value = 0.1
		}
		hidden_effect = {
			c:SPA = {
				remove_diplomatic_pact = {
					country = c:GRA
					type = puppet
				}
			}
		}
		c:SPA = {
			create_diplomatic_pact = {
				country = c:GRA
				type = dominion
			}
		}
		ai_chance = {
			base = 1
		}
	}
}

# The Colombian Alliance has won the War of Independence
dvg_granada.3 = {
	type = country_event
	placement = ROOT

	title = dvg_granada.3.t
	desc = dvg_granada.3.d
	flavor = dvg_granada.3.f
	
	event_image = {
		video = "southamerica_aristocrats"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/aristocrats"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	trigger = {
	}
		
	# Independence!
	option = {
		name = dvg_granada.3.a
		default_option = yes
		add_loyalists = {
			value = 0.1
		}
		ig:ig_rural_folk = {
				add_ruling_interest_group = yes
				add_modifier = {
                    name = dvg_approval_buff
                    days = 730
                    is_decaying = yes
				}
		}		
		c:SPA = {
			remove_diplomatic_pact = {
				country = c:GRA
				type = puppet
			}
		}
		change_relations = {
			country = c:SPA
			value = -50
		}
		hidden_effect = {
			if = {
				limit = {
					has_law = law_type:law_monarchy
				}
				activate_law = law_type:law_presidential_republic
			}
		}
		ai_chance = {
			base = 1
		}
	}

	# We shall stand with Spain... for now.
	option = {
		name = dvg_granada.3.b
		add_radicals = {
			value = 0.1
		}
		hidden_effect = {
			c:SPA = {
				remove_diplomatic_pact = {
					country = c:GRA
					type = puppet
				}
			}
		}
		c:SPA = {
			create_diplomatic_pact = {
				country = c:GRA
				type = dominion
			}
		}
		hidden_effect = {
			if = {
				limit = {
					NOT = { has_global_variable = dvg_herrera_revolution_happened }
				}
			}
			c:GRA = {
				trigger_event = { id = dvg_granada.5 days = 730 }	# Herrera Revolution
			}
		}
		ai_chance = {
			base = 0
		}
	}
}

# Truce of 1838
dvg_granada.4 = {
	type = country_event
	placement = ROOT

	title = dvg_granada.4.t
	desc = dvg_granada.4.d
	flavor = dvg_granada.4.f
	
	event_image = {
		video = "southamerica_aristocrats"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/aristocrats"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	trigger = {
	}
	
	# We shall stand with Spain... for now.
	option = {
		name = dvg_granada.4.a
		hidden_effect = {
			c:SPA = {
				remove_diplomatic_pact = {
					country = c:GRA
					type = puppet
				}
			}
		}
		c:SPA = {
			create_diplomatic_pact = {
				country = c:GRA
				type = dominion
			}
		}
		hidden_effect = {
			if = {
				limit = {
					NOT = { has_global_variable = dvg_herrera_revolution_happened }
				}
			}
			c:GRA = {
				trigger_event = { id = dvg_granada.5 days = 730 }	# Herrera Revolution
			}
		}
		ai_chance = {
			base = 1
		}
	}
}

# The Herrera Revolution
dvg_granada.5 = {
	type = country_event
	placement = ROOT

	title = dvg_granada.5.t
	desc = dvg_granada.5.d
	flavor = dvg_granada.5.f
	
	event_image = {
		video = "southamerica_aristocrats"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/aristocrats"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	trigger = {
	}
	
	immediate = {
		if = {
			limit = {
				NOT = { exists = c:SAN }
			}
			create_country = { # Herreria
				tag = SAN
				origin = this
				state = s:STATE_ANTIOQUIA.region_state:GRA
				state = s:STATE_CUNDINAMARCA.region_state:GRA
				state = s:STATE_CAUCA.region_state:GRA
				on_created = {
					if = {
						limit = {
							NOT = {
								has_law = law_type:law_presidential_republic
							}
						}
						activate_law = law_type:law_presidential_republic
					}
				}
			}
		}
		
		c:SAN = {
			create_character = {
				ruler = yes
				is_general = yes
				historical = yes
				first_name = Guillermo
				last_name = Blanco
				dna = dna_francisco_de_paula_santander
				birth_date = 1789.12.10
				hq = region_gran_colombia
				interest_group = ig_armed_forces
				ideology = ideology_ethno_nationalist
				traits = {
					meticulous
					experienced_defensive_strategist
					firebrand
				}
			}
		}
		set_global_variable = {
			name = dvg_herrera_revolution_happened
			value = yes
		}
	}
	
	# We must safeguard our borders
	option = {
		name = dvg_granada.5.a
		default_option = yes	
		create_diplomatic_play = {
			target_country = c:SAN
			war = no
			type = dp_annex_war
			add_war_goal = {
				holder = c:SAN
				type = annex_country
				target_country = c:GRA
			}
		}
		ai_chance = {
			base = 0.5
		}
	}

	# de Blanco shall lead us to victory (play as Herreria)
	option = {
		name = dvg_granada.5.b		
		create_diplomatic_play = {
			target_country = c:SAN
			war = no
			type = dp_annex_war
			add_war_goal = {
				holder = c:SAN
				type = annex_country
				target_country = c:GRA
			}
		}
		play_as = c:SAN
		ai_chance = {
			base = 0
		}
	}
	
	# Let Herreria go (as Granada) (THIS WILL HAVE CONSEQUENCES)
	option = {
		name = dvg_granada.5.c
		c:GRA = {
			create_truce = {
				country = c:SAN
				months = 48
			}
		}
		c:GRA = {
			trigger_event = { id = dvg_granada.6 days = 7 }	# Collapse of Granada
		}
		ai_chance = {
			base = 0.5
		}
	}
	
	# Let Herreria go (as Herreria) (THIS WILL HAVE CONSEQUENCES)
	option = {
		name = dvg_granada.5.c
		play_as = c:SAN
		c:GRA = {
			create_truce = {
				country = c:SAN
				months = 48
			}
		}
		c:GRA = {
			trigger_event = { id = dvg_granada.6 days = 7 }	# Collapse of Granada
		}
		ai_chance = {
			base = 0
		}
	}
}

# Collapse of Granada
dvg_granada.6 = {
	type = country_event
	placement = ROOT

	title = dvg_granada.6.t
	desc = dvg_granada.6.d
	flavor = dvg_granada.6.f
	
	event_image = {
		video = "southamerica_aristocrats"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/aristocrats"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	trigger = {
	}
	
	immediate = {
		set_global_variable = {
			name = dvg_granada_collapse_happened
			value = yes
		}
	}
	
	# Become Aureliana
	option = {
		name = dvg_granada.6.a
		default_option = yes
		create_country = {
			tag = ESQ
			origin = this
			state = s:STATE_GUAYANA.region_state:GRA
			state = s:STATE_PARA.region_state:GRA
			on_created = {
				if = {
					limit = {
						NOT = {
							has_law = law_type:law_presidential_republic
						}
					}
					activate_law = law_type:law_presidential_republic
				}
			}
		}
		change_tag = CST
		set_capital = STATE_MIRANDA
		hidden_effect = {
			c:CST = {
				remove_primary_culture = cu:guianan
			}
		}
		c:CST = {
			ruler = { kill_character = yes }
			create_character = {
				ruler = yes
				is_general = yes
				historical = yes
				first_name = Antonio
				last_name = Rocafuerte
				birth_date = 1782.8.10
				interest_group = ig_armed_forces
				ideology = ideology_royalist
				traits = {
					persistent
					expert_offensive_planner
					romantic
				}
			}
		}
		c:ESQ = {
			ruler = { kill_character = yes }
			create_character = {
				ruler = yes
				is_general = yes
				historical = yes
				first_name = Amedeo
				last_name = Cagni
				birth_date = 1788.3.17
				interest_group = ig_intelligentsia
				ideology = ideology_reformer
				traits = {
					direct
					meticulous
					stalwart_defender
				}
			}
		}
		if = {
			limit = {
				NOT = {
					has_law = law_type:law_presidential_republic
				}
			}
			activate_law = law_type:law_presidential_republic
		}
		c:CST = {
			create_truce = {
				country = c:SAN
				months = 48
			}
			create_truce = {
				country = c:ESQ
				months = 48
			}
		}
		c:SPA = {
			remove_diplomatic_pact = {
				country = c:CST
				type = puppet
			}
		}
		c:SPA = {
			remove_diplomatic_pact = {
				country = c:CST
				type = dominion
			}
		}
		change_relations = {
			country = c:SPA
			value = -50
		}
		ai_chance = {
			base = 1
		}
	}
	
	# Become Essequibo
	option = {
		name = dvg_granada.6.b
		default_option = yes
		create_country = {
			tag = CST
			origin = this
			state = s:STATE_ZULIA.region_state:GRA
			state = s:STATE_MIRANDA.region_state:GRA
			state = s:STATE_GUAVIARE.region_state:GRA
			state = s:STATE_ANGOSTURA.region_state:GRA
			state = s:STATE_BOLIVAR.region_state:GRA
			on_created = {
				if = {
					limit = {
						NOT = {
							has_law = law_type:law_presidential_republic
						}
					}
					activate_law = law_type:law_presidential_republic
				}
			}
		}
		change_tag = ESQ
		set_capital = STATE_GUAYANA
		hidden_effect = {
			c:ESQ = {
				remove_primary_culture = cu:granadan
			}
		}
		c:CST = {
			ruler = { kill_character = yes }
			create_character = {
				ruler = yes
				is_general = yes
				historical = yes
				first_name = Antonio
				last_name = Rocafuerte
				birth_date = 1782.8.10
				interest_group = ig_armed_forces
				ideology = ideology_royalist
				traits = {
					persistent
					expert_offensive_planner
					romantic
				}
			}
		}
		c:ESQ = {
			ruler = { kill_character = yes }
			create_character = {
				ruler = yes
				is_general = yes
				historical = yes
				first_name = Amedeo
				last_name = Cagni
				birth_date = 1788.3.17
				interest_group = ig_intelligentsia
				ideology = ideology_reformer
				traits = {
					direct
					meticulous
					stalwart_defender
				}
			}
		}
		if = {
			limit = {
				NOT = {
					has_law = law_type:law_presidential_republic
				}
			}
			activate_law = law_type:law_presidential_republic
		}
		c:ESQ = {
			create_truce = {
				country = c:SAN
				months = 48
			}
			create_truce = {
				country = c:CST
				months = 48
			}
		}
		c:SPA = {
			remove_diplomatic_pact = {
				country = c:ESQ
				type = puppet
			}
		}
		c:SPA = {
			remove_diplomatic_pact = {
				country = c:ESQ
				type = dominion
			}
		}
		change_relations = {
			country = c:SPA
			value = -50
		}
		ai_chance = {
			base = 0
		}
	}
}

# The Bombing of Caracas Armory
dvg_granada.7 = {
	type = country_event
	placement = ROOT

	title = dvg_granada.7.t
	desc = dvg_granada.7.d
	flavor = dvg_granada.7.f
	
	event_image = {
		video = "southamerica_aristocrats"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/aristocrats"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	trigger = {
		year = 1837
		this = c:GRA
		c:SPA = {
			has_war_with = c:GCO
			NOT = { has_truce_with = c:GCO }
		}
	}
	
	# It was probably just some freak accident
	option = {
		name = dvg_granada.7.a
		default_option = yes
		add_radicals = {
			value = 0.2
			culture = cu:granadan
		}		
		ai_chance = {
			base = 1
		}
	}
}